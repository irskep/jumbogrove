<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../">
  <title data-ice="title">Manual | Jumbo Grove</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<link rel="stylesheet" href="./inject/css/0-app.css"><link rel="stylesheet" href="./inject/css/0-style.css"><script src="./inject/script/0-jumbogrove.js"></script><script src="./inject/script/0-script.js"></script><meta name="description" content="An interactive fiction game engine"><meta property="twitter:card" content="summary"><meta property="twitter:title" content="Jumbo Grove"><meta property="twitter:description" content="An interactive fiction game engine"></head>
<body class="layout-container manual-root" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/irskep/jumbogrove"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div class="manual-toc-root">
  
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/Readme.html"><a href="manual/Readme.html" data-ice="link">Jumbo Grove</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/Readme.html"><a href="manual/Readme.html#features" data-ice="link">Features</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/Readme.html"><a href="manual/Readme.html#quick-start" data-ice="link">Quick Start</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/Readme.html"><a href="manual/Readme.html#docs" data-ice="link">Docs</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/Readme.html"><a href="manual/Readme.html#-a-href--http---steveasleep-com-jumbogrove-manual-tutorial-basics-html--tutorial--a-" data-ice="link">Tutorial</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/Readme.html"><a href="manual/Readme.html#-a-href--http---steveasleep-com-jumbogrove-identifiers-html--api--a-" data-ice="link">API</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/Readme.html"><a href="manual/Readme.html#demo" data-ice="link">Demo</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/Readme.html"><a href="manual/Readme.html#demo-source-code" data-ice="link">Demo source code</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/Readme.html"><a href="manual/Readme.html#-quot-jumbo-grove-quot--" data-ice="link">&quot;Jumbo Grove&quot;?</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/where_to_find_the_api.html"><a href="manual/where_to_find_the_api.html" data-ice="link">Where to find the API reference</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/tutorial_basics.html"><a href="manual/tutorial_basics.html" data-ice="link">The Basics</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial_basics.html"><a href="manual/tutorial_basics.html#the-maze" data-ice="link">The Maze</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial_basics.html"><a href="manual/tutorial_basics.html#introducing-situations" data-ice="link">Introducing situations</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial_basics.html"><a href="manual/tutorial_basics.html#laying-out-the-maze" data-ice="link">Laying out the maze</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial_basics.html"><a href="manual/tutorial_basics.html#introducing-tags" data-ice="link">Introducing Tags</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial_basics.html"><a href="manual/tutorial_basics.html#maze-game-teleporter-pads" data-ice="link">Maze game teleporter pads</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/tutorial_scripting.html"><a href="manual/tutorial_scripting.html" data-ice="link">Scripting Choices</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial_scripting.html"><a href="manual/tutorial_scripting.html#custom-option-text" data-ice="link">Custom option text</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial_scripting.html"><a href="manual/tutorial_scripting.html#remembering-things" data-ice="link">Remembering things</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial_scripting.html"><a href="manual/tutorial_scripting.html#model-globalstate" data-ice="link">model.globalState</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/tutorial_scripting.html"><a href="manual/tutorial_scripting.html#tiny-maze-example" data-ice="link">Tiny maze example</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial_scripting.html"><a href="manual/tutorial_scripting.html#priority" data-ice="link">Priority</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/tutorial_templates.html"><a href="manual/tutorial_templates.html" data-ice="link">Templates</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial_templates.html"><a href="manual/tutorial_templates.html#world--39-s-simplest-puzzle" data-ice="link">World&apos;s Simplest Puzzle</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial_templates.html"><a href="manual/tutorial_templates.html#template-context" data-ice="link">Template Context</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial_templates.html"><a href="manual/tutorial_templates.html#custom-filters" data-ice="link">Custom Filters</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial_templates.html"><a href="manual/tutorial_templates.html#with-markdown--amp--whitespace" data-ice="link">With Markdown &amp; Whitespace</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial_templates.html"><a href="manual/tutorial_templates.html#adding-css" data-ice="link">Adding CSS</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial_templates.html"><a href="manual/tutorial_templates.html#template-comment-syntax" data-ice="link">Template Comment Syntax</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/tutorial_templates.html"><a href="manual/tutorial_templates.html#changing-template-engines" data-ice="link">Changing Template Engines</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/tutorial_actions.html"><a href="manual/tutorial_actions.html" data-ice="link">Actions</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/tutorial_characters.html"><a href="manual/tutorial_characters.html" data-ice="link">Characters</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/tutorial_saving.html"><a href="manual/tutorial_saving.html" data-ice="link">Saving &amp; Loading</a></li>
</ul>
  </div>
</div>
</nav>

<div class="content" data-ice="content"><div class="github-markdown" data-ice="content"><h1 id="scripting-choices">Scripting Choices</h1><p>In this guide:</p>
<ul>
<li><code>situation.optionText</code> as a function (<code>function(model, host) -&gt; Bool</code>)</li>
<li><code>situation.getCanSee(model, host) -&gt; Bool</code></li>
<li><code>situation.getCanChoose(model, host) -&gt; Bool</code></li>
<li><code>situation.enter(model, ui, fromSituation)</code></li>
<li><code>situation.priority</code></li>
<li><code>model.globalState</code></li>
</ul>
<h2 id="custom-option-text">Custom option text</h2><p><em>This section builds on the code from <a href="./manual/tutorial_basics.html">the previous section</a>.</em></p>
<p>You might have noticed that when you first &quot;Enter the maze&quot; and then
&quot;Go to E,&quot; one of the options is still &quot;Enter the maze,&quot; which takes you
back to Cell A.</p>
<p>We can fix this using a little bit of JavaScript. <code>situation.optionText</code> can be either
a string, or a function! (<a href="./manual/../class/src/jg/situation.js~Situation.html">You can see a reference for all the <code>situation</code> values
here</a>.)</p>
<p>It looks like this:</p>
<pre><code class="lang-js"><code class="source-code prettyprint">{
  id: &apos;my-situation&apos;,
  optionText: function(model, hostSituation) {
    return &apos;a string&apos;;
  }
}</code>
</code></pre>
<p>The <code>model</code> argument will be explained later. <code>hostSituation</code> is the
situation that is presenting the choice.</p>
<p>Here&apos;s how we can use that in our game.
(From here on out, when we&apos;re just modifying one situation, we&apos;ll just list out
the code for that situation, instead of the whole game.)</p>
<pre><code class="lang-js"><code class="source-code prettyprint">jumbogrove.jumbogrove(&apos;#game&apos;, {
  id: &apos;maze-game&apos;,
  situations: [
    /* ... */
    { id: &apos;A&apos;,

      /* THIS IS THE IMPORTANT PART */
      optionText: function(model, hostSituation) {
        if (hostSituation.id === &apos;start&apos;) {
          return &apos;Enter the maze&apos;;
        } else {
          return &apos;Go to A&apos;;
        }
      },
      /* end important part */

      content: &quot;You are standing in cell A.&quot;,
      choices: [&apos;E&apos;] },
    /* ... */
  ]
})</code>
</code></pre>
<p>We can also add some spice to our teleporter cells. Instead of &quot;Go to X&quot;, they
can say &quot;Teleport to X&quot; if they are being presented as a choice from another
teleporter situation.</p>
<p>There is a method on situation objects,
<a href="./manual/../class/src/jg/situation.js~Situation.html#instance-method-hasTag"><code>Situation.hasTag()</code></a>,
that we can use to quickly determine if the &quot;host&quot; situation (the situation presenting
the choice) has a particular tag.</p>
<pre><code class="lang-js"><code class="source-code prettyprint">jumbogrove.jumbogrove(&apos;#game&apos;, {
  id: &apos;maze-game&apos;,
  situations: [
    /* ... */
      {
        id: &apos;D&apos;,
        tags: [&apos;teleporter&apos;],
        optionText: function(model, host) {
          if (host.hasTag(&apos;teleporter&apos;)) {
            return &apos;Teleport to D&apos;;
          } else {
            return &apos;Go to D&apos;;
          }
        },
        content: &quot;You are standing in cell D. There is a teleporter here.&quot;,
        choices: [&apos;H&apos;, &apos;#teleporter&apos;]
      },
    /* ... */
      {
        id: &apos;L&apos;,
        tags: [&apos;teleporter&apos;],
        optionText: function(model, host) {
          if (host.hasTag(&apos;teleporter&apos;)) {
            return &apos;Teleport to L&apos;;
          } else {
            return &apos;Go to L&apos;;
          }
        },
        content: &quot;You are standing in cell L. There is a teleporter here.&quot;,
        choices: [&apos;K&apos;, &apos;P&apos;, &apos;#teleporter&apos;]
      },
      {
        id: &apos;M&apos;,
        tags: [&apos;teleporter&apos;],
        optionText: function(model, host) {
          if (host.hasTag(&apos;teleporter&apos;)) {
            return &apos;Teleport to M&apos;;
          } else {
            return &apos;Go to M&apos;;
          }
        },
        content: &quot;You are standing in cell M. There is a teleporter here.&quot;,
        choices: [&apos;N&apos;, &apos;#teleporter&apos;]
      },
    /* ... */
  ]
})</code>
</code></pre>
<p>If you&apos;re an experienced JavaScript programmer you might want to consolidate that
logic a bit. Go right ahead!</p>
<p>Here are the changes in action. You can walk to cell D by visiting cells
<code>AEFBCGHD</code>, where you can see the teleporter options.</p>
<p><div id="maze-4" class="jg-headless"></div>

</p>
<h2 id="remembering-things">Remembering things</h2><p>Let&apos;s design a new maze. It will be physically smaller, but it will require
the player to find a key to solve.</p>
<pre><code><code class="source-code prettyprint">+-------+-------+
|       |       |
|  key  | exit   
|       |       |
+-     -+- door-+
|       |       |
| start   empty |
|       |       |
+-------+-------+</code>
</code></pre><p>We want our logic to look something like this:</p>
<ul>
<li>When the player enters the &apos;key&apos; room,<ul>
<li>Then remember that the player has the key.</li>
<li>Once the player has the key, stop showing the &apos;key&apos; room.</li>
</ul>
</li>
<li>When the player enters the empty room,<ul>
<li>Only show the <code>door</code> choice if they have the key.</li>
</ul>
</li>
</ul>
<p>To accomplish this task, we need to use three new features of situations.
Each one is a function you can provide which is called by Jumbo Grove
when something happens or a decision needs to be made.</p>
<ul>
<li><code>situation.getCanSee(model, host)</code> may prevent the host situation from displaying
this situation as a choice by returning <code>false</code>.</li>
<li><code>situation.getCanChoose(model, host)</code> may let the player <em>see</em> a choice,
but not <em>take</em> it. This is so they know there is an option they haven&apos;t
yet unlocked.</li>
<li><code>situation.enter(model, ui, fromSituation)</code> is called when the player
enters a situation, <em>after</em> <code>content</code> has been shown.</li>
</ul>
<p>And finally, we need to make use of the <code>model</code>. The model object
<a href="./manual/../class/src/jg/model.js~model.html">does a lot of things.</a>
What we care about right now is the <code>model.globalState</code> object.</p>
<h3 id="model-globalstate">model.globalState</h3><p>This object may contain anything you like, as long as it is safe too
convert it to JSON. <code>globalState</code> is part of your game&apos;s <em>save file</em>.</p>
<p>Things that can be converted to JSON include:</p>
<ul>
<li>Numbers</li>
<li>Strings (<code>&quot;hello&quot;</code>)</li>
<li>Booleans (<code>true</code>, <code>false</code>)</li>
<li>Lists or objects containing numbers, strings, or booleans</li>
</ul>
<p><em>Everything else</em> is unsafe to use.</p>
<h3 id="tiny-maze-example">Tiny maze example</h3><p>Here&apos;s our tiny maze game in full:</p>
<pre><code class="lang-js"><code class="source-code prettyprint">jumbogrove.jumbogrove(&apos;#game&apos;, {
  id: &apos;prison-escape&apos;,
  // You can specify the initial value of globalState like this
  globalState: {
    playerHasKey: false,
  },
  situations: [
    {
      id: &apos;start&apos;,
      optionText: &apos;Return to your bedroom&apos;,
      content: `
        You are standing in a cold, damp cell. A straw mattress lies in
        the corner.
      `,
      choices: [&apos;key-room&apos;, &apos;door-room&apos;],
    },

    {
      id: &apos;key-room&apos;,
      // In the ASCII map I drew this as a whole room, but the flavor
      // text just calls it a hole in the wall.
      optionText: &apos;Inspect hole in the wall&apos;,
      getCanSee: function(model, host) {
        // only visible if player doesn&apos;t already have the key
        return model.globalState.playerHasKey === false;
      },
      enter: function(model, ui, from) {
        model.globalState.playerHasKey = true;
      },
      content: `
        There is a key hidden in the hole!
      `,
      choices: [&apos;start&apos;]
    },

    {
      id: &apos;door-room&apos;,
      optionText: &apos;Walk to the other end of the room&apos;,
      content: `
        There is a locked door here.
      `,
      choices: [&apos;start&apos;, &apos;win-the-game&apos;]
    },

    {
      id: &apos;win-the-game&apos;,
      optionText: &apos;Unlock the door&apos;,
      getCanChoose: function(model, host) {
        // only pickable if player DOES have the key
        return model.globalState.playerHasKey === true;
      },
      content: `
        You walk out into the hallway. You&apos;re free!

        # Game Over
      `
    }

  ]
});</code>
</code></pre>
<p><div id="prison-escape" class="jg-headless"></div>

</p>
<h2 id="priority">Priority</h2><p>Imagine you&apos;re making a game about a high school crush. The player is
at a party, and may talk to anyone. But when their crush walks in the
room, all they can do is stammer and stare.</p>
<p>We could write a <code>getCanSee</code> function for every person you talk to,
but it&apos;s much simpler to use <code>situation.priority</code>!</p>
<p>When a situation&apos;s choices have different priorities, it only shows
choices of situations <em>with the highest priority.</em></p>
<p>So if situations A, B, and C have <code>priority: 0</code>, but situations E and F
have <code>priority: 1</code>, then only E and F will be presented.</p>
<p>All situations have priority 0 by default.</p>
<p>Here&apos;s a small demonstration:</p>
<pre><code class="lang-js"><code class="source-code prettyprint">jumbogrove.jumbogrove(&apos;#game&apos;, {
  id: &apos;party-crush&apos;,
  globalState: {
    turnsUntilCrushEnters: 2,
    hasTalkedToJeff: false,
    hasTalkedToXiao: false,
    hasTalkedToMegan: false,
    hasTalkedToMarta: false
  },
  situations: [
    {
      id: &apos;start&apos;,
      content: &quot;You have entered a pretty chill party.&quot;,
      choices: [&apos;#talk-to-someone&apos;],
    },

    {
      id: &apos;jeff&apos;, tags: [&apos;talk-to-someone&apos;],
      optionText: &quot;Talk to Jeff&quot;,
      getCanSee: function(model) { return !model.globalState.hasTalkedToJeff; },
      enter: function(model) {
        model.globalState.hasTalkedToJeff = true;
        model.globalState.turnsUntilCrushEnters -= 1;
      },
      content: &quot;You catch up with Jeff. He aced his math test.&quot;,
      choices: [&apos;#talk-to-someone&apos;]
    },

    {
      id: &apos;xiao&apos;, tags: [&apos;talk-to-someone&apos;],
      optionText: &quot;Talk to Xiao&quot;,
      getCanSee: function(model) { return !model.globalState.hasTalkedToXiao; },
      enter: function(model) {
        model.globalState.hasTalkedToXiao = true;
        model.globalState.turnsUntilCrushEnters -= 1;
      },
      content: &quot;You catch up with Xiao. He scored the winning goal at a football game.&quot;,
      choices: [&apos;#talk-to-someone&apos;]
    },

    {
      id: &apos;megan&apos;, tags: [&apos;talk-to-someone&apos;],
      optionText: &quot;Talk to Megan&quot;,
      getCanSee: function(model) { return !model.globalState.hasTalkedToMegan; },
      enter: function(model) {
        model.globalState.hasTalkedToMegan = true;
        model.globalState.turnsUntilCrushEnters -= 1;
      },
      content: &quot;You catch up with Megan. She tells you about a short story she wrote.&quot;,
      choices: [&apos;#talk-to-someone&apos;]
    },

    {
      id: &apos;marta&apos;, tags: [&apos;talk-to-someone&apos;],
      optionText: &quot;Talk to Marta&quot;,
      getCanSee: function(model) { return !model.globalState.hasTalkedToMarta; },
      enter: function(model) {
        model.globalState.hasTalkedToMarta = true;
        model.globalState.turnsUntilCrushEnters -= 1;
      },
      content: &quot;You catch up with Marta. She just beat her personal best deadlift.&quot;,
      choices: [&apos;#talk-to-someone&apos;]
    },

    {
      id: &apos;crush&apos;, tags: [&apos;talk-to-someone&apos;],
      optionText: &quot;Your crush is here&quot;,
      priority: 1,
      getCanSee: function(model) {
        return model.globalState.turnsUntilCrushEnters &lt;= 0;
      },
      content: `
      You see your crush enter the party. You immediately forget how to speak.
      You stammer uncontrollably, trying to excuse yourself while you escape
      out the back door.

      # The End
      `
    }

  ]
});</code>
</code></pre>
<p><div id="party-crush" class="jg-headless"></div></p>
</div>
</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.0.4)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
